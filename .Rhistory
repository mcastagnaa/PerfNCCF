length(unique(pdataSet$FundCode))
laggedMod <- lm(NCCF ~
RelPerf1m
+ AbsPerf1m
+ RelPerf3m
+ AbsPerf3m
+ RelPerf3y
+ Rank1y
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
+ lag(pdataSet$RelPerf1m, 4)
+ lag(pdataSet$RelPerf1m, 5)
+ lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
+ lag(pdataSet$AbsPerf1m, 4)
+ lag(pdataSet$AbsPerf1m, 5)
+ lag(pdataSet$AbsPerf1m, 6)
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$Rank1m, 4)
+ lag(pdataSet$Rank1m, 5)
+ lag(pdataSet$Rank1m, 6)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
+ lag(pdataSet$RelPerf3m, 4)
+ lag(pdataSet$RelPerf3m, 5)
+ lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
+ lag(pdataSet$AbsPerf3m, 4)
+ lag(pdataSet$AbsPerf3m, 5)
+ lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
+ lag(pdataSet$Rank3m, 4)
+ lag(pdataSet$Rank3m, 5)
+ lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
library(plm)
panelSet <- na.omit(panelA[, c("FundCode"
, "RefDate"
, "NCCF"
, "AbsPerf1m"
, "RelPerf1m"
, "AbsPerf3m"
, "RelPerf3m"
, "Rank3m"
, "Rank1m"
, "Rank1y"
, "RelPerf3y")])
pdataSet <- pdata.frame(panelSet
, index = c("FundCode", "RefDate")
, drop.index = FALSE
, row.names = TRUE)
rm(panelSet)
laggedMod <- lm(NCCF ~
RelPerf1m
+ AbsPerf1m
+ RelPerf3m
+ AbsPerf3m
+ RelPerf3y
+ Rank1y
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
+ lag(pdataSet$RelPerf1m, 4)
+ lag(pdataSet$RelPerf1m, 5)
+ lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
+ lag(pdataSet$AbsPerf1m, 4)
+ lag(pdataSet$AbsPerf1m, 5)
+ lag(pdataSet$AbsPerf1m, 6)
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$Rank1m, 4)
+ lag(pdataSet$Rank1m, 5)
+ lag(pdataSet$Rank1m, 6)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
+ lag(pdataSet$RelPerf3m, 4)
+ lag(pdataSet$RelPerf3m, 5)
+ lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
+ lag(pdataSet$AbsPerf3m, 4)
+ lag(pdataSet$AbsPerf3m, 5)
+ lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
+ lag(pdataSet$Rank3m, 4)
+ lag(pdataSet$Rank3m, 5)
+ lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
finalLags <- step(laggedMod, direction="both")
summary(finalLags)
discMod <- lm(NCCF ~
+ RelPerf3m
+ RelPerf3y
+ lag(pdataSet$RelPerf1m, 4)
+ lag(pdataSet$RelPerf1m, 5)
+ lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 3)
+ lag(pdataSet$RelPerf3m, 4)
+ lag(pdataSet$RelPerf3m, 5)
+ lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 5)
+ lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
summary(discMod)
discMod <- lm(NCCF ~
+ RelPerf3m
+ RelPerf3y
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 3)
, data=pdataSet, na.action=na.omit)
summary(discMod)
summary(finalLags)
discMod <- lm(NCCF ~
+ Rank1y
+ RelPerf3y
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 3)
, data=pdataSet, na.action=na.omit)
summary(discMod)
discMod <- lm(NCCF ~
+ Rank1y
+ RelPerf3y
#+ lag(pdataSet$Rank1m, 2)
#+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$RelPerf3m, 1)
#+ lag(pdataSet$RelPerf3m, 3)
, data=pdataSet, na.action=na.omit)
summary(discMod)
discMod <- lm(NCCF ~
+ Rank1y
+ RelPerf3y
#+ lag(pdataSet$Rank1m, 2)
#+ lag(pdataSet$Rank1m, 3)
#+ lag(pdataSet$RelPerf3m, 1)
#+ lag(pdataSet$RelPerf3m, 3)
, data=pdataSet, na.action=na.omit)
summary(discMod)
laggedMod <- lm(NCCF ~
RelPerf3m
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
+ lag(pdataSet$RelPerf1m, 4)
+ lag(pdataSet$RelPerf1m, 5)
+ lag(pdataSet$RelPerf1m, 6)
+ AbsPerf1m
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
+ lag(pdataSet$AbsPerf1m, 4)
+ lag(pdataSet$AbsPerf1m, 5)
+ lag(pdataSet$AbsPerf1m, 6)
+ Rank1m
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
+ lag(pdataSet$Rank1m, 4)
+ lag(pdataSet$Rank1m, 5)
+ lag(pdataSet$Rank1m, 6)
, data=pdataSet, na.action=na.omit)
# laggedMod <- lm(NCCF ~
#                   RelPerf1m
#                 + AbsPerf1m
#                 + RelPerf3m
#                 + AbsPerf3m
#                 + RelPerf3y
#                 + Rank1y
#                 + lag(pdataSet$RelPerf1m, 1)
#                 + lag(pdataSet$RelPerf1m, 2)
#                 + lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
#                 + lag(pdataSet$AbsPerf1m, 1)
#                 + lag(pdataSet$AbsPerf1m, 2)
#                 + lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
#                 + lag(pdataSet$Rank1m, 1)
#                 + lag(pdataSet$Rank1m, 2)
#                 + lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
#                 + lag(pdataSet$RelPerf3m, 1)
#                 + lag(pdataSet$RelPerf3m, 2)
#                 + lag(pdataSet$RelPerf3m, 3)
#                 + lag(pdataSet$RelPerf3m, 4)
#                 + lag(pdataSet$RelPerf3m, 5)
#                 + lag(pdataSet$RelPerf3m, 6)
#                 + lag(pdataSet$AbsPerf3m, 1)
#                 + lag(pdataSet$AbsPerf3m, 2)
#                 + lag(pdataSet$AbsPerf3m, 3)
#                 + lag(pdataSet$AbsPerf3m, 4)
#                 + lag(pdataSet$AbsPerf3m, 5)
#                 + lag(pdataSet$AbsPerf3m, 6)
#                 + lag(pdataSet$Rank3m, 1)
#                 + lag(pdataSet$Rank3m, 2)
#                 + lag(pdataSet$Rank3m, 3)
#                 + lag(pdataSet$Rank3m, 4)
#                 + lag(pdataSet$Rank3m, 5)
#                 + lag(pdataSet$Rank3m, 6)
#                 , data=pdataSet, na.action=na.omit)
#summary(laggedMod)
finalLags <- step(laggedMod, direction="both")
summary(finalLags)
rm(laggedMod)
source('~/.active-rstudio-document', echo=TRUE)
laggedMod <- lm(NCCF ~
RelPerf3m
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
+ lag(pdataSet$RelPerf3m, 4)
+ lag(pdataSet$RelPerf3m, 5)
+ lag(pdataSet$RelPerf3m, 6)
+ AbsPerf3m
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
+ lag(pdataSet$AbsPerf3m, 4)
+ lag(pdataSet$AbsPerf3m, 5)
+ lag(pdataSet$AbsPerf3m, 6)
+ Rank3m
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
+ lag(pdataSet$Rank3m, 4)
+ lag(pdataSet$Rank3m, 5)
+ lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
# laggedMod <- lm(NCCF ~
#                   RelPerf3m
#                 + lag(pdataSet$RelPerf1m, 1)
#                 + lag(pdataSet$RelPerf1m, 2)
#                 + lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
#                 + AbsPerf1m
#                 + lag(pdataSet$AbsPerf1m, 1)
#                 + lag(pdataSet$AbsPerf1m, 2)
#                 + lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
#                 + Rank1m
#                 + lag(pdataSet$Rank1m, 1)
#                 + lag(pdataSet$Rank1m, 2)
#                 + lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
#                 , data=pdataSet, na.action=na.omit)
# laggedMod <- lm(NCCF ~
#                   RelPerf1m
#                 + AbsPerf1m
#                 + RelPerf3m
#                 + AbsPerf3m
#                 + RelPerf3y
#                 + Rank1y
#                 + lag(pdataSet$RelPerf1m, 1)
#                 + lag(pdataSet$RelPerf1m, 2)
#                 + lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
#                 + lag(pdataSet$AbsPerf1m, 1)
#                 + lag(pdataSet$AbsPerf1m, 2)
#                 + lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
#                 + lag(pdataSet$Rank1m, 1)
#                 + lag(pdataSet$Rank1m, 2)
#                 + lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
#                 + lag(pdataSet$RelPerf3m, 1)
#                 + lag(pdataSet$RelPerf3m, 2)
#                 + lag(pdataSet$RelPerf3m, 3)
#                 + lag(pdataSet$RelPerf3m, 4)
#                 + lag(pdataSet$RelPerf3m, 5)
#                 + lag(pdataSet$RelPerf3m, 6)
#                 + lag(pdataSet$AbsPerf3m, 1)
#                 + lag(pdataSet$AbsPerf3m, 2)
#                 + lag(pdataSet$AbsPerf3m, 3)
#                 + lag(pdataSet$AbsPerf3m, 4)
#                 + lag(pdataSet$AbsPerf3m, 5)
#                 + lag(pdataSet$AbsPerf3m, 6)
#                 + lag(pdataSet$Rank3m, 1)
#                 + lag(pdataSet$Rank3m, 2)
#                 + lag(pdataSet$Rank3m, 3)
#                 + lag(pdataSet$Rank3m, 4)
#                 + lag(pdataSet$Rank3m, 5)
#                 + lag(pdataSet$Rank3m, 6)
#                 , data=pdataSet, na.action=na.omit)
#summary(laggedMod)
finalLags <- step(laggedMod, direction="both")
summary(finalLags)
rm(laggedMod)
discMod <- lm(NCCF ~
+ Rank1y
+ RelPerf3y
#+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank3m, 2)
#+ lag(pdataSet$RelPerf3m, 1)
#+ lag(pdataSet$RelPerf3m, 3)
, data=pdataSet, na.action=na.omit)
summary(discMod)
source('~/.active-rstudio-document', echo=TRUE)
laggedMod <- lm(NCCF ~
RelPerf1m
+ AbsPerf1m
+ RelPerf3m
+ AbsPerf3m
+ RelPerf3y
+ Rank1y
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
#                 + lag(pdataSet$RelPerf3m, 4)
#                 + lag(pdataSet$RelPerf3m, 5)
#                 + lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
#                 + lag(pdataSet$AbsPerf3m, 4)
#                 + lag(pdataSet$AbsPerf3m, 5)
#                 + lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
#                 + lag(pdataSet$Rank3m, 4)
#                 + lag(pdataSet$Rank3m, 5)
#                 + lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
#summary(laggedMod)
finalLags <- step(laggedMod, direction="both")
summary(finalLags)
rm(laggedMod)
laggedMod <- lm(NCCF ~
RelPerf1m
+ AbsPerf1m
+ RelPerf3m
+ AbsPerf3m
+ RelPerf3y
+ Rank1y
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
#                 + lag(pdataSet$RelPerf3m, 4)
#                 + lag(pdataSet$RelPerf3m, 5)
#                 + lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
#                 + lag(pdataSet$AbsPerf3m, 4)
#                 + lag(pdataSet$AbsPerf3m, 5)
#                 + lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
#                 + lag(pdataSet$Rank3m, 4)
#                 + lag(pdataSet$Rank3m, 5)
#                 + lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
finalLags <- step(laggedMod, direction="both")
finalLags <- step(laggedMod, direction="backward")
library(plm)
panelSet <- na.omit(panelA[, c("FundCode"
, "RefDate"
, "NCCF"
, "AbsPerf1m"
, "RelPerf1m"
, "AbsPerf3m"
, "RelPerf3m"
, "Rank3m"
, "Rank1m"
, "Rank1y"
, "RelPerf3y")])
pdataSet <- pdata.frame(panelSet
, index = c("FundCode", "RefDate")
, drop.index = FALSE
, row.names = TRUE)
rm(panelSet)
panelSet <- na.omit(panelA[, c("FundCode"
, "RefDate"
, "NCCF"
, "AbsPerf1m"
, "RelPerf1m"
, "AbsPerf3m"
, "RelPerf3m"
, "Rank3m"
, "Rank1m"
, "Rank1y"
, "RelPerf3y")])
pdataSet <- pdata.frame(panelSet
, index = c("FundCode", "RefDate")
, drop.index = FALSE
, row.names = TRUE)
rm(panelSet)
head(pdataSet)
length(unique(pdataSet$FundCode))
laggedMod <- lm(NCCF ~
RelPerf1m
+ AbsPerf1m
+ RelPerf3m
+ AbsPerf3m
+ RelPerf3y
+ Rank1y
+ lag(pdataSet$RelPerf1m, 1)
+ lag(pdataSet$RelPerf1m, 2)
+ lag(pdataSet$RelPerf1m, 3)
#                 + lag(pdataSet$RelPerf1m, 4)
#                 + lag(pdataSet$RelPerf1m, 5)
#                 + lag(pdataSet$RelPerf1m, 6)
+ lag(pdataSet$AbsPerf1m, 1)
+ lag(pdataSet$AbsPerf1m, 2)
+ lag(pdataSet$AbsPerf1m, 3)
#                 + lag(pdataSet$AbsPerf1m, 4)
#                 + lag(pdataSet$AbsPerf1m, 5)
#                 + lag(pdataSet$AbsPerf1m, 6)
+ lag(pdataSet$Rank1m, 1)
+ lag(pdataSet$Rank1m, 2)
+ lag(pdataSet$Rank1m, 3)
#                 + lag(pdataSet$Rank1m, 4)
#                 + lag(pdataSet$Rank1m, 5)
#                 + lag(pdataSet$Rank1m, 6)
+ lag(pdataSet$RelPerf3m, 1)
+ lag(pdataSet$RelPerf3m, 2)
+ lag(pdataSet$RelPerf3m, 3)
#                 + lag(pdataSet$RelPerf3m, 4)
#                 + lag(pdataSet$RelPerf3m, 5)
#                 + lag(pdataSet$RelPerf3m, 6)
+ lag(pdataSet$AbsPerf3m, 1)
+ lag(pdataSet$AbsPerf3m, 2)
+ lag(pdataSet$AbsPerf3m, 3)
#                 + lag(pdataSet$AbsPerf3m, 4)
#                 + lag(pdataSet$AbsPerf3m, 5)
#                 + lag(pdataSet$AbsPerf3m, 6)
+ lag(pdataSet$Rank3m, 1)
+ lag(pdataSet$Rank3m, 2)
+ lag(pdataSet$Rank3m, 3)
#                 + lag(pdataSet$Rank3m, 4)
#                 + lag(pdataSet$Rank3m, 5)
#                 + lag(pdataSet$Rank3m, 6)
, data=pdataSet, na.action=na.omit)
